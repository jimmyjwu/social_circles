<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<!-- <svg width="50" height="50">
  <circle cx="25" cy="25" r="25" fill="purple" />
</svg>
 -->

<script>
  var graph; 
  {% load staticfiles %}
  d3.json("{% static "social_circles/force.json" %}", function(error, json) {
    if (error) return console.warn(error);
    graph = json;
    console.log(graph);

    // Create a force layout to display nodes.
    var force = d3.layout.force()
      .charge(-120)
      .linkDistance(40)
      .nodes(graph.nodes)
      .links(graph.links)
      .size([parseInt(d3.select('#graph').style('width'), 10),
             parseInt(d3.select('#graph').style('height'), 10)]);

      // Append an <svg> element to body for rendering (warning: SVG sucks and will
      // probably hang Firefox, so use Chrome).
      var svg = d3.select('body')
        .append('svg')
        .attr('width', parseInt(d3.select('#graph').style('width'), 10))
        .attr('height', parseInt(d3.select('#graph').style('height'), 10));

      // Add the edges to the SVG.
      var edge = svg.selectAll('line.edge')
          .data(graph.links)
          .enter().append('line')
          .attr('class', 'edge')
          .style('stroke', 'rgba(200, 200, 200, 0.2)')
          .style('stroke-width', 0.5);

      // Add the nodes to the SVG.
      var node = svg.selectAll('circle.node')
          .data(graph.nodes)
          .enter().append('circle')
          .attr('class', 'node')
          .attr('r', 5)
          .style('fill', '#aaa')
          .style('cursor', 'pointer')
          .call(force.drag);

      // Hook up some events to D3.js.
      force.on('tick', function() {
              node.attr('cx', function(d) { return d.x; })
                  .attr('cy', function(d) { return d.y; });

              edge.attr('x1', function(d) { return d.source.x; })
                  .attr('y1', function(d) { return d.source.y; })
                  .attr('x2', function(d) { return d.target.x; })
                  .attr('y2', function(d) { return d.target.y; });
          });

      // Start the visualization.
      force.start();
  });

  
</script>


<img src="{% static "social_circles/graph.png" %}" alt="graph"/>

<div id="graph"></div>

<p>
	Clusters:
</p>

{% for cluster in clusters %}
	<p>
		{{ cluster|join:', ' }}
	</p>
{% endfor %}